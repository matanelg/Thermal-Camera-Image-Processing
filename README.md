# Image Processing For Thermal Camera

## Introduction

During the FEL-THz accelerator operation at Ariel University, hazardous ionizing radiation is emitted.<br />
In addition accelerator's overheat can create research errors and even damage the accelerator itself.<br />
Therefore, there is a need to develop a control and diagnostic system that will monitor the heat levels in the accelerator at any given moment and alert the user in the event of an abnormal temperature exceeding 50 ° C. For this purpose, a FLIR-Ax8 thermal camera was purchased which will be located in the accelerator room and operated from the control room by an image processing algorithm in LabVIEW development environment. The system will alert the user by voice and visual alert, photograph and save the thermal image and record the image data in a CSV file.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/acc.png">
</p>


## Project's Softwares

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/labv.png" width="50%" height="70%" />
</p>


## Heat And Electromagnetic Radiation

- With the IR sensor in the thermal camera, the accelerator temperature can be estimated based on the electromagnetic radiation emitted by it.
- The temperature translation is made possible by detecting the wavelength at the maximum intensity of the radiation emitted by Planck's law.​​
- Planck Law - describes the relationship between the intensity of radiation and the wavelength emittedby the accelerator in certain temperature.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/ew.png" width="70%" height="70%" />
</p>


## FLIR-Ax8 Thermal camera

- The camera sensor is built from Uncooled micro-bolometer detector that makes up the camera's IR resolution in 80x60 pixel.

- Each pixel in the array has resistance, which changes as a result of the heat generated by the radiation hit, Therefore the voltage level at each pixel varies with the radiation absorbed.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/ml.png" width="80%" height="80%" />
</p>

- The analog voltage levels go through A/D Converted and presented as a thermal image, so that each voltage level is associated with a certain color in the color scale.

- The camera sensor is capable of absorbing IR radiation at wavelengths which range from 7.5-13 um in the longwave infrared area.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/lr range.png" width="100%" height="100%" />
</p>

- The communication between the camera and the computer is done through the local area network, where the type of communication is according to the Ethernet standard.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/cm.png" width="80%" height="80%" />
</p>

- This project uses Get/Post requeststhe of HTTP protocol to communicate between the camera and LabVIEW software.

- Technical data:
Image resolution:  640 × 480.
Temperature range:  –10 ° C to + 150 ° C (14 ° F to 302 ° F).​
Error - ± 2 ° C.​
JPEG image format.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/fl3.png" width="30%" height="30%" />
</p>



## Image Processing

- The received image does not contain radiometric data and therefore image processing is required.

- The image mapping is done by adjusting temperature values to the color values that received from the thermal image.​​

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/ip.png" width="100%" height="100%" />
</p>


## System Structure

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/block.png" width="100%" height="100%" />
</p>


## LabVIEW Sub-Vis

- File Exist - Check the existence of a file in a folder

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/file exist.png" width="60%" height="60%" />
</p>

- Login - Perform communication with FLIR-Ax8 Cmara interface.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/login.png" width="60%" height="60%" />
</p>

- Image Path & Name -  Providing a file name and address.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/image path.png" width="60%" height="60%" />
</p>

- Slide - Design the temperature bar in the display window.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/slide.png" width="60%" height="60%" />
</p>

- Take Picture - Photo taken by the user.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/take pic.png" width="60%" height="60%" />
</p>

- Server Image Data - Interprets the pixel map levels of the thermal image.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/server.png" width="60%" height="60%" />
</p>

- Save Image & Message - Save the thermal image and pop up a warning window.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/save image1.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/save image2.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/save inage3.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/save image4.png" width="60%" height="60%" />
</p>

- Documentation - Record the status data in which the thermal image was taken.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Documentation 1.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Documentation 2.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Documentation 3.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Documentation 4.png" width="60%" height="60%" />
</p>

- Color Palette To Temperature Vector - Mapping image colors.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Color Palette To Temperature Vector.png" width="60%" height="60%" />
</p>

- Color To Temperature Function - Processing the image and calculating the temperature value.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Color To Temperature Function.png" width="60%" height="60%" />
</p>

- Notification by Reference - Control the flashing lights and reset button in the display window.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Notification by 1.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Notification by 2.png" width="100%" height="100%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Notification by 3.png" width="60%" height="60%" />
</p>

- Alarm Function -  Alarm sounding at an abnormal temperature

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/alarm.png" width="60%" height="60%" />
</p>

- Calibration -  Perform system error correction.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Calibration1.png" width="60%" height="60%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Calibration2.png" width="100%" height="100%" />
</p>

- Palette & Temp Vector - New mapping for 44-62 degree temperature range.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/Palette & Temp.png" width="60%" height="60%" />
</p>


## LabVIEW Main-Vi

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/main2.png" width="60%" height="60%" />
</p>


## User Interface

- ​The Initialize window -  User defines call details, directory for saving data and CSV file name.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/ini.png" width="60%" height="60%" />
</p>

- ​​​The Thermal window - where the customer receives alerts and control the app.​

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/thermal.png" width="60%" height="60%" />
</p>

- ​​The Data window - where the events are recorded.​​​​

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/data.png" width="60%" height="60%" />
</p>


## System Operations Tests

- ​When the temperature is below the limit.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/w1.png" width="60%" height="60%" />
</p>

- ​When the temperature is over the limit.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/w2.png" width="60%" height="60%" />
</p>


## Performance Improvement

- ​By comparing app performance to other measuring devices it was detected that there is an average error of 2.6 degrees.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/test1.png" width="100%" height="100%" />
</p>

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/err.png" width="100%" height="100%" />
</p>

- ​Calibrate the system using linear regression reduce the average error to 0.5 degrees.

<p align="center">
  <img src="https://github.com/matanelg/Thermal-Camera-Image-Processing/blob/master/images/lin.png" width="100%" height="100%" />
</p>


## Summary And Conclusions

- This project is designed to monitor and warn of abnormal heat levels in the FEL-THz accelerator.

- To test the system, an experiment was done by taking an object at different temperatures.

- The tests during the project finally led to improved app performance.

​​

​





